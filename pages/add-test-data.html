<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Ajouter Données de Test</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f5f5f5; }
    .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    h1 { color: #333; }
    button { padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; }
    button:hover { background: #5568d3; }
    #output { margin-top: 20px; padding: 15px; background: #f0f0f0; border-radius: 4px; font-size: 12px; font-family: monospace; max-height: 400px; overflow-y: auto; }
    .success { color: green; }
    .error { color: red; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Ajouter Données de Test</h1>
    <p>Cliquez pour ajouter 11 activités pour la semaine courante (Dec 22-28, 2025)</p>
    <button onclick="addTestData()">Ajouter les Activités</button>
    <div id="output"></div>
  </div>

  <script>
    const API_BASE = 'http://localhost:9090/projet-planning-intelligent';
    const output = document.getElementById('output');

    const activities = [
      { titre: 'Rapport mensuel', description: 'Synthèse décembre', debut: '2025-12-22T10:00:00', fin: '2025-12-22T12:00:00', priorite: 'HAUTE', statut: 'EN_COURS' },
      { titre: 'Réunion client', description: 'Présentation projet', debut: '2025-12-23T14:00:00', fin: '2025-12-23T15:30:00', priorite: 'HAUTE', statut: 'PLANIFIE' },
      { titre: 'Formation SQL', description: 'Optimisation requêtes', debut: '2025-12-24T09:00:00', fin: '2025-12-24T12:00:00', priorite: 'NORMALE', statut: 'PLANIFIE' },
      { titre: 'Gym', description: 'Session cardio', debut: '2025-12-24T18:00:00', fin: '2025-12-24T19:00:00', priorite: 'BASSE', statut: 'PLANIFIE' },
      { titre: 'Révision code', description: 'Review tickets', debut: '2025-12-25T09:00:00', fin: '2025-12-25T11:00:00', priorite: 'NORMALE', statut: 'TERMINE' },
      { titre: 'Réunion équipe', description: 'Standup', debut: '2025-12-26T09:30:00', fin: '2025-12-26T10:00:00', priorite: 'HAUTE', statut: 'TERMINE' },
      { titre: 'Documentation API', description: 'API REST endpoints', debut: '2025-12-26T14:00:00', fin: '2025-12-26T17:00:00', priorite: 'NORMALE', statut: 'EN_COURS' },
      { titre: 'Yoga', description: 'Séance relaxation', debut: '2025-12-27T17:00:00', fin: '2025-12-27T18:00:00', priorite: 'BASSE', statut: 'PLANIFIE' },
      { titre: 'Réunion planning', description: 'Sprint planning', debut: '2025-12-28T09:00:00', fin: '2025-12-28T10:30:00', priorite: 'HAUTE', statut: 'PLANIFIE' },
      { titre: 'Développement feature', description: 'Fatigue index', debut: '2025-12-28T11:00:00', fin: '2025-12-28T14:00:00', priorite: 'HAUTE', statut: 'EN_COURS' },
      { titre: 'Test unitaire', description: 'Couverture 80%', debut: '2025-12-28T14:30:00', fin: '2025-12-28T16:00:00', priorite: 'NORMALE', statut: 'PLANIFIE' }
    ];

    async function addTestData() {
      output.innerHTML = '<p>Ajout en cours...</p>';
      let count = 0;
      let errors = 0;

      for (const a of activities) {
        const params = new URLSearchParams({
          action: 'create',
          userId: '2',
          titre: a.titre,
          description: a.description,
          debut: a.debut,
          fin: a.fin,
          priorite: a.priorite,
          statut: a.statut
        });
        
        try {
          const resp = await fetch(`${API_BASE}/activites`, {
            method: 'POST',
            body: params,
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' }
          });
          const result = await resp.json();
          if (result.status === 'ok') {
            output.innerHTML += `<p class="success">✓ ${a.titre}</p>`;
            count++;
          } else {
            output.innerHTML += `<p class="error">✗ ${a.titre}: ${JSON.stringify(result)}</p>`;
            errors++;
          }
        } catch (e) {
          output.innerHTML += `<p class="error">✗ ${a.titre}: ${e.message}</p>`;
          errors++;
        }
      }

      output.innerHTML += `<p><strong>Résultat: ${count} ajoutées, ${errors} erreurs</strong></p>`;
      output.innerHTML += '<p><a href="index.html">Retour au tableau de bord</a></p>';
    }
  </script>
</body>
</html>
